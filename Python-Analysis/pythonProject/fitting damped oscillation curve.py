import numpy as np
from scipy.optimize import curve_fit
import matplotlib.pyplot as plt
import pandas as pd
from sympy import *
import math

data = pd.read_csv("robotic_arm.csv")

time1 = np.array(data['Time'].ravel())
time1 = np.around(time1,2)
degree1 = np.array(data['Degree'].ravel())
degree1 = np.around(degree1,2)

startline1 = 4400
endline1 = 5340

time1 = time1[startline1:endline1] - time1[startline1]
degree1 = degree1[startline1:endline1]
time1 = time1 * 0.001

angle = np.array([32.56, 32.55, 32.51, 32.50, 32.52, 32.55, 32.55, 32.56, 32.49, 32.31, 32.16, 31.68, 31.37, 30.88, 30.63, 30.59, 30.66, 30.71, 30.33, 29.58, 28.84, 28.51, 27.96, 27.77, 27.04, 26.06, 25.67, 25.00, 24.40, 24.11, 23.53, 22.75, 21.37, 20.34, 19.90, 19.21, 18.74, 18.54, 17.06, 15.79, 15.23, 14.27, 13.86, 13.18, 11.65, 11.02, 9.92, 9.08, 8.72, 8.06, 6.99, 6.29, 5.03, 3.95, 3.48, 2.68, 2.36, 1.36, 0.23, -0.29, -1.24, -2.07, -2.46, -3.42, -4.47, -4.93, -5.72, -6.08, -6.76, -7.41, -7.84, -8.64, -9.37, -9.70, -10.32, -10.88, -11.14, -11.68, -11.93, -12.46, -12.99, -13.25, -13.75, -13.98, -14.10, -14.38, -14.68, -14.86, -15.26, -15.48, -15.47, -15.55, -15.61, -15.79, -16.03, -16.17, -15.94, -15.84, -15.84, -15.93, -16.00, -16.18, -15.98, -15.71, -15.29, -15.02, -14.94, -14.86, -14.42, -14.03, -13.40, -12.88, -12.67, -12.32, -12.19, -11.48, -10.45, -10.02, -9.29, -8.69, -8.41, -7.94, -6.62, -6.04, -5.03, -4.61, -3.87, -3.29, -2.63, -1.43, -0.38, 0.10, 0.95, 1.33, 2.00, 3.16, 3.69, 4.63, 5.49, 5.90, 6.65, 7.71, 8.20, 9.10, 9.49, 10.25, 10.94, 11.28, 11.99, 12.69, 13.01, 13.66, 14.25, 14.54, 15.00, 15.18, 15.55, 15.97, 16.19, 16.63, 16.82, 16.79, 16.82, 16.84, 16.94, 17.13, 17.25, 17.22, 16.94, 16.85, 16.77, 16.76, 16.78, 16.44, 16.11, 15.57, 15.20, 15.05, 14.84, 14.75, 14.29, 13.51, 13.16, 12.59, 12.18, 12.01, 11.73, 10.72, 10.27, 9.51, 8.90, 8.62, 8.17, 7.59, 6.58, 5.73, 5.34, 4.69, 4.14, 3.89, 2.80, 1.85, 1.43, 0.70, 0.38, -0.23, -1.17, -1.58, -2.34, -2.98, -3.26, -3.78, -4.36, -4.69, -5.30, -5.58, -6.11, -6.61, -6.84, -7.31, -7.78, -8.01, -8.45, -8.68, -9.12, -9.53, -9.72, -10.10, -10.50, -10.69, -11.10, -11.52, -11.59, -11.75, -11.85, -12.07, -12.34, -12.48, -12.56, -12.48, -12.46, -12.50, -12.60, -12.67, -12.86, -12.68, -12.36, -12.16, -12.10, -11.99, -11.99, -12.02, -12.10, -12.23, -12.31, -12.49, -12.59, -12.83, -11.69, -11.20, -10.37, -9.68, -9.40, -8.94, -8.20, -7.71, -6.81, -6.06, -5.72, -5.11, -4.83, -3.72, -2.77, -2.34, -1.61, -0.98, -0.69, 0.08, 0.56, 1.43, 2.17, 2.50, 3.12, 3.85, 4.26, 5.06, 5.42, 6.12, 6.75, 7.04, 7.65, 8.30, 8.60, 9.18, 9.72, 9.99, 10.50, 10.72, 11.18, 11.59, 11.81, 12.23, 12.64, 12.67, 12.77, 12.84, 13.02, 13.21, 13.32, 13.56, 13.37, 13.31, 13.24, 13.26, 13.28, 13.37, 13.18, 12.87, 12.65, 12.57, 12.48, 12.44, 12.46, 11.90, 11.66, 11.27, 10.97, 10.86, 10.69, 10.22, 9.87, 9.27, 8.78, 8.58, 8.25, 8.10, 7.27, 6.59, 6.29, 5.77, 5.35, 5.16, 4.59, 4.22, 3.54, 2.98, 2.72, 2.27, 1.65, 1.27, 0.59, 0.01, -0.25, -0.72, -0.94, -1.45, -2.07, -2.35, -2.86, -3.30, -3.51, -3.94, -4.42, -4.64, -5.05, -5.24, -5.63, -6.03, -6.22, -6.59, -6.95, -7.13, -7.48, -7.81, -7.98, -8.17, -8.27, -8.49, -8.71, -8.83, -9.09, -9.11, -9.15, -9.23, -9.34, -9.42, -9.59, -9.67, -9.48, -9.36, -9.34, -9.30, -9.32, -9.34, -9.15, -8.84, -8.71, -8.50, -8.42, -8.30, -7.99, -7.75, -7.35, -7.03, -6.89, -6.70, -6.54, -6.26, -5.77, -5.57, -5.22, -4.94, -4.84, -4.36, -3.68, -3.38, -2.84, -2.39, -2.17, -1.82, -1.43, -0.77, -0.17, 0.10, 0.59, 1.01, 1.19, 1.79, 2.05, 2.51, 2.95, 3.15, 3.51, 4.04, 4.29, 4.76, 5.19, 5.40, 5.77, 5.94, 6.36, 6.77, 6.98, 7.38, 7.74, 7.92, 8.20, 8.33, 8.58, 8.86, 8.99, 9.27, 9.39, 9.38, 9.40, 9.43, 9.47, 9.56, 9.62, 9.43, 9.30, 9.26, 9.22, 9.22, 9.23, 9.07, 8.93, 8.70, 8.52, 8.47, 8.40, 8.39, 8.17, 7.81, 7.53, 7.42, 7.20, 7.13, 6.79, 6.29, 6.08, 5.72, 5.42, 5.29, 5.09, 4.81, 4.34, 3.94, 3.77, 3.47, 3.23, 2.95, 2.49, 2.06, 1.88, 1.54, 1.39, 1.13, 0.64, 0.43, 0.05, -0.30, -0.47, -0.77, -1.25, -1.45, -1.85, -2.04, -2.37, -2.69, -2.83, -3.14, -3.43, -3.57, -3.84, -3.97, -4.22, -4.43, -4.53, -4.73, -4.93, -5.04, -5.26, -5.41, -5.47, -5.58, -5.64, -5.78, -5.95, -6.02, -6.07, -6.05, -6.04, -6.06, -6.10, -6.16, -6.12, -6.06, -5.95, -5.91, -5.90, -5.89, -5.90, -5.76, -5.56, -5.41, -5.35, -5.27, -5.23, -5.17, -4.86, -4.73, -4.53, -4.36, -4.30, -4.19, -3.79, -3.62, -3.32, -3.19, -2.97, -2.79, -2.71, -2.24, -1.85, -1.67, -1.35, -1.21, -0.94, -0.53, -0.35, -0.01, 0.30, 0.46, 0.73, 1.07, 1.25, 1.57, 1.72, 2.00, 2.24, 2.35, 2.58, 2.78, 2.89, 3.09, 3.18, 3.37, 3.59, 3.73, 3.97, 4.19, 4.31, 4.53, 4.75, 4.85, 5.05, 5.14, 5.33, 5.52, 5.60, 5.67, 5.65, 5.65, 5.66, 5.67, 5.74, 5.78, 5.73, 5.63, 5.57, 5.56, 5.54, 5.54, 5.46, 5.32, 5.26, 5.17, 5.11, 5.08, 5.06, 4.87, 4.80, 4.68, 4.60, 4.58, 4.53, 4.51, 4.22, 4.00, 3.89, 3.71, 3.57, 3.50, 3.15, 3.00, 2.74, 2.51, 2.39, 2.22, 1.99, 1.87, 1.63, 1.42, 1.34, 1.17, 1.10, 0.85, 0.61, 0.51, 0.31, 0.11, 0.04, -0.17, -0.27, -0.48, -0.68, -0.76, -0.94, -1.11, -1.20, -1.38, -1.46, -1.63, -1.78, -1.84, -1.94, -1.99, -2.03, -2.09, -2.17, -2.21, -2.31, -2.32, -2.34, -2.40, -2.43, -2.48, -2.53, -2.52, -2.52, -2.52, -2.52, -2.53, -2.56, -2.61, -2.51, -2.47, -2.41, -2.36, -2.34, -2.32, -2.21, -2.03, -1.89, -1.84, -1.74, -1.68, -1.66, -1.52, -1.38, -1.33, -1.24, -1.21, -1.16, -1.03, -0.94, -0.80, -0.66, -0.60, -0.52, -0.37, -0.29, -0.13, -0.06, 0.04, 0.16, 0.20, 0.33, 0.49, 0.58, 0.72, 0.85, 0.91, 1.05, 1.12, 1.26, 1.38, 1.43, 1.56, 1.65, 1.69, 1.76, 1.79, 1.88, 1.97, 2.02, 2.10, 2.19, 2.24, 2.32, 2.43, 2.48, 2.56, 2.55, 2.57, 2.58, 2.58, 2.61, 2.65, 2.68, 2.62, 2.60, 2.58, 2.58, 2.59, 2.60, 2.47, 2.41, 2.32, 2.25, 2.23, 2.19, 2.18, 2.08, 2.00, 1.97, 1.93, 1.88, 1.86, 1.72, 1.66, 1.56, 1.50, 1.45, 1.38, 1.27, 1.17, 1.00, 0.88, 0.83, 0.71, 0.66, 0.52, 0.34, 0.27, 0.12, 0.01, -0.04, -0.15, -0.19, -0.29, -0.37, -0.39, -0.47, -0.54, -0.61, -0.72, -0.79, -0.90, -0.99, -1.05, -1.15, -1.21, -1.24, -1.33, -1.41, -1.44, -1.52, -1.53, -1.53, -1.54, -1.56, -1.61, -1.64, -1.61, -1.56, -1.55, -1.55, -1.55, -1.55, -1.56, -1.48, -1.44, -1.39, -1.35, -1.33, -1.30, -1.29, -1.21, -1.16, -1.14, -1.11, -1.09, -1.08, -0.98, -0.94, -0.87, -0.82, -0.80, -0.75, -0.64, -0.57, -0.44, -0.35, -0.29, -0.20, -0.16, -0.06, 0.05, 0.10, 0.17, 0.23, 0.27, 0.35, 0.44, 0.49, 0.58, 0.61, 0.68, 0.75, 0.79, 0.88, 0.97, 1.00, 1.08, 1.13, 1.21, 1.30, 1.35, 1.45, 1.52, 1.56, 1.63, 1.65, 1.69, 1.72, 1.73, 1.80, 1.85, 1.83, 1.78, 1.76, 1.76, 1.76, 1.76, 1.77, 1.72, 1.69, 1.66, 1.63, 1.64, 1.66, 1.65, 1.61, 1.61, 1.61, 1.62, 1.63, 1.64, 1.56, 1.53, 1.44, 1.37, 1.34, 1.30, 1.17, 1.12, 1.03, 0.99, 0.93, 0.85, 0.82, 0.74, 0.68, 0.66, 0.61, 0.55, 0.53, 0.48, 0.44, 0.35, 0.28, 0.26, 0.20, 0.11, 0.06, -0.02, -0.07, -0.16, -0.23, -0.25, -0.33, -0.38, -0.40, -0.43, -0.50, -0.52, -0.56, -0.57, -0.58, -0.60, -0.62, -0.67, -0.71, -0.70, -0.68, -0.67, -0.66, -0.70, -0.71, -0.74, -0.76, -0.77, -0.79, -0.80, -0.82, -0.85, -0.84, -0.82, -0.81, -0.81, -0.81, -0.81, -0.81, -0.82, -0.82, -0.83, -0.85, -0.86, -0.89, -0.84, -0.80, -0.76, -0.76, -0.74, -0.72, -0.70, -0.64, -0.58, -0.53, -0.49, -0.46, -0.44, -0.44, -0.41, -0.36, -0.31, -0.27, -0.24, -0.18, -0.10, -0.03, 0.03, 0.03, 0.08, 0.13, 0.22, 0.29, 0.36, 0.42, 0.46, 0.55, 0.55, 0.62, ])
time = np.array([0, 11, 21, 31, 40, 51, 61, 71, 81, 90, 101, 111, 121, 130, 141, 151, 161, 170, 181, 191, 201, 211, 221, 231, 241, 251, 260, 271, 281, 291, 300, 311, 321, 331, 340, 351, 361, 371, 381, 391, 401, 411, 421, 430, 441, 451, 461, 470, 481, 491, 501, 510, 521, 531, 541, 551, 560, 571, 581, 591, 600, 611, 621, 631, 640, 651, 661, 671, 680, 691, 701, 711, 721, 730, 741, 751, 761, 770, 781, 791, 801, 810, 821, 831, 841, 851, 861, 871, 881, 891, 900, 911, 921, 931, 940, 951, 961, 971, 980, 991, 1001, 1011, 1021, 1031, 1041, 1051, 1061, 1070, 1081, 1091, 1101, 1110, 1121, 1131, 1141, 1150, 1161, 1171, 1181, 1191, 1200, 1211, 1221, 1231, 1240, 1251, 1261, 1271, 1280, 1291, 1301, 1311, 1320, 1331, 1341, 1351, 1361, 1370, 1381, 1391, 1401, 1410, 1421, 1431, 1441, 1450, 1461, 1471, 1481, 1491, 1501, 1511, 1521, 1531, 1540, 1551, 1561, 1571, 1580, 1591, 1601, 1611, 1620, 1631, 1641, 1651, 1661, 1671, 1681, 1691, 1701, 1710, 1721, 1731, 1741, 1750, 1761, 1771, 1781, 1790, 1801, 1811, 1821, 1831, 1840, 1851, 1861, 1871, 1880, 1891, 1901, 1911, 1920, 1931, 1941, 1951, 1960, 1971, 1981, 1991, 2001, 2010, 2021, 2031, 2041, 2050, 2061, 2071, 2081, 2090, 2101, 2111, 2121, 2131, 2141, 2151, 2161, 2171, 2180, 2191, 2201, 2211, 2220, 2231, 2241, 2251, 2260, 2271, 2281, 2291, 2301, 2311, 2321, 2331, 2341, 2350, 2361, 2371, 2381, 2390, 2401, 2411, 2421, 2430, 2441, 2451, 2461, 2471, 2480, 2491, 2501, 2511, 2520, 2531, 2541, 2551, 2560, 2571, 2581, 2591, 2600, 2611, 2621, 2631, 2641, 2650, 2661, 2671, 2681, 2690, 2701, 2711, 2721, 2730, 2741, 2751, 2761, 2771, 2781, 2791, 2801, 2811, 2820, 2831, 2841, 2851, 2860, 2871, 2881, 2891, 2900, 2911, 2921, 2931, 2941, 2951, 2961, 2971, 2981, 2990, 3001, 3011, 3021, 3030, 3041, 3051, 3061, 3070, 3081, 3091, 3101, 3111, 3120, 3131, 3141, 3151, 3160, 3171, 3181, 3191, 3200, 3211, 3221, 3231, 3240, 3251, 3261, 3271, 3281, 3290, 3301, 3311, 3321, 3330, 3341, 3351, 3361, 3370, 3381, 3391, 3401, 3411, 3421, 3431, 3441, 3451, 3460, 3471, 3481, 3491, 3500, 3511, 3521, 3531, 3540, 3551, 3561, 3571, 3581, 3591, 3601, 3611, 3621, 3630, 3641, 3651, 3661, 3670, 3681, 3691, 3701, 3710, 3721, 3731, 3741, 3751, 3760, 3771, 3781, 3791, 3800, 3811, 3821, 3831, 3840, 3851, 3861, 3871, 3880, 3891, 3901, 3911, 3921, 3930, 3941, 3951, 3961, 3970, 3981, 3991, 4001, 4010, 4021, 4031, 4041, 4051, 4061, 4071, 4081, 4091, 4100, 4111, 4121, 4131, 4140, 4151, 4161, 4171, 4180, 4191, 4201, 4211, 4221, 4231, 4241, 4251, 4261, 4270, 4281, 4291, 4301, 4310, 4321, 4331, 4341, 4350, 4361, 4371, 4381, 4391, 4400, 4411, 4421, 4431, 4440, 4451, 4461, 4471, 4480, 4491, 4501, 4511, 4520, 4531, 4541, 4551, 4561, 4570, 4581, 4591, 4601, 4610, 4621, 4631, 4641, 4650, 4661, 4671, 4681, 4691, 4701, 4711, 4721, 4731, 4740, 4751, 4761, 4771, 4780, 4791, 4801, 4811, 4820, 4831, 4841, 4851, 4861, 4871, 4881, 4891, 4901, 4910, 4921, 4931, 4941, 4950, 4961, 4971, 4981, 4990, 5001, 5011, 5021, 5031, 5040, 5051, 5061, 5071, 5080, 5091, 5101, 5111, 5120, 5131, 5141, 5151, 5160, 5171, 5181, 5191, 5201, 5210, 5221, 5231, 5241, 5250, 5261, 5271, 5281, 5290, 5301, 5311, 5321, 5331, 5341, 5351, 5361, 5371, 5380, 5391, 5401, 5411, 5420, 5431, 5441, 5451, 5460, 5471, 5481, 5491, 5501, 5511, 5521, 5531, 5541, 5550, 5561, 5571, 5581, 5590, 5601, 5611, 5621, 5630, 5641, 5651, 5661, 5671, 5680, 5691, 5701, 5711, 5720, 5731, 5741, 5751, 5760, 5771, 5781, 5791, 5800, 5811, 5821, 5831, 5841, 5850, 5861, 5871, 5881, 5890, 5901, 5911, 5921, 5930, 5941, 5951, 5961, 5971, 5981, 5991, 6001, 6011, 6020, 6031, 6041, 6051, 6060, 6071, 6081, 6091, 6100, 6111, 6121, 6131, 6141, 6151, 6161, 6171, 6181, 6190, 6201, 6211, 6221, 6230, 6241, 6251, 6261, 6270, 6281, 6291, 6301, 6311, 6320, 6331, 6341, 6351, 6360, 6371, 6381, 6391, 6400, 6411, 6421, 6431, 6440, 6451, 6461, 6471, 6481, 6490, 6501, 6511, 6521, 6530, 6541, 6551, 6561, 6570, 6581, 6591, 6601, 6611, 6621, 6631, 6641, 6651, 6660, 6671, 6681, 6691, 6700, 6711, 6721, 6731, 6740, 6751, 6761, 6771, 6781, 6791, 6801, 6811, 6821, 6830, 6841, 6851, 6861, 6870, 6881, 6891, 6901, 6910, 6921, 6931, 6941, 6951, 6960, 6971, 6981, 6991, 7000, 7011, 7021, 7031, 7040, 7051, 7061, 7071, 7080, 7091, 7101, 7111, 7121, 7130, 7141, 7151, 7161, 7170, 7181, 7191, 7201, 7210, 7221, 7231, 7241, 7251, 7261, 7271, 7281, 7291, 7300, 7311, 7321, 7331, 7340, 7351, 7361, 7371, 7380, 7391, 7401, 7411, 7421, 7431, 7441, 7451, 7461, 7470, 7481, 7491, 7501, 7510, 7521, 7531, 7541, 7550, 7561, 7571, 7581, 7591, 7600, 7611, 7621, 7631, 7640, 7651, 7661, 7671, 7680, 7691, 7701, 7711, 7720, 7731, 7741, 7751, 7761, 7770, 7781, 7791, 7801, 7810, 7821, 7831, 7841, 7850, 7861, 7871, 7881, 7891, 7901, 7911, 7921, 7931, 7940, 7951, 7961, 7971, 7980, 7991, 8001, 8011, 8020, 8031, 8041, 8051, 8061, 8071, 8081, 8091, 8101, 8110, 8121, 8131, 8141, 8150, 8161, 8171, 8181, 8190, 8201, 8211, 8221, 8231, 8240, 8251, 8261, 8271, 8280, 8291, 8301, 8311, 8320, 8331, 8341, 8351, 8360, 8371, 8381, 8391, 8401, 8410, 8421, 8431, 8441, 8450, 8461, 8471, 8481, 8490, 8501, 8511, 8521, 8531, 8541, 8551, 8561, 8571, 8580, 8591, 8601, 8611, 8620, 8631, 8641, 8651, 8660, 8671, 8681, 8691, 8701, 8711, 8721, 8731, 8741, 8750, 8761, 8771, 8781, 8790, 8801, 8811, 8821, 8830, 8841, 8851, 8861, 8871, 8880, 8891, 8901, 8911, 8920, 8931, 8941, 8951, 8960, 8971, 8981, 8991, 9000, 9011, 9021, 9031, 9041, 9050, 9061, 9071, 9081, 9090, 9101, 9111, 9121, 9130, 9141, 9151, 9161, 9171, 9181, 9191, 9201, 9211, 9220, 9231, 9241, 9251, 9260, 9271, 9281, 9291, 9300, 9311, 9321, 9331, 9341, 9351, 9361, 9371, 9381, 9390, 9401, 9411, 9421, 9430, 9441, 9451, 9461, 9470, 9481, 9491, 9501, 9511, 9520, 9531, 9541, 9551, 9560, 9571, 9581, 9591, 9600, 9611, 9621, 9631, 9640, 9651, 9661, 9671, 9681, 9690, 9701, 9711, 9721, 9730, 9741, 9751, 9761, 9770, 9781, 9791, 9801, 9811, 9821, 9831, 9841, 9851, 9860, 9871, 9881, 9891, 9900, 9911, 9921, 9931, 9940, 9951, 9961, 9971, 9981, 9991, 10001, 10011, 10021, 10030, 10041, ])
time = time * 0.001

startline = 100
endline = 500

time = time[startline:endline] - time[startline]
angle = angle[startline:endline]

'''
1. y(t) is the instantaneous amplitude at time t;
2. A is the initial amplitude of the envelope;
3. Lambda is the decay rate, in the reciprocal of the time units of the independent variable t;
4. Phi is the phase angle at t = 0;
5. Omega  is the angular frequency.

https://en.wikipedia.org/wiki/Damping
'''
def damped_oscillation(t, A, Lambda, Omega, Phi, C):
    return A * np.exp((-1) * Lambda * t) * np.sin(Omega * t + Phi) + C

A, B, C, D, E = curve_fit(damped_oscillation, time, angle)[0]
print("The parameters of previous torsion spring:",curve_fit(damped_oscillation, time, angle)[0])
# 数据点与原先的进行画图比较
fitted_angle = A * np.exp((-1) * B * time) * np.sin(C * time + D) + E
zeta = Symbol('zeta')
omega = Symbol('omega')
solved_value=solve([zeta * omega - B, omega * ((1 - (zeta*zeta))**0.5) - C], [zeta, omega])
print(solved_value)
zeta = solved_value[0][0]
omega = solved_value[0][1]
frequency = omega / 2 / math.pi

A1, B1, C1, D1, E1 = curve_fit(damped_oscillation, time1, degree1)[0]
print("The parameters of latest torsion spring:",curve_fit(damped_oscillation, time1, degree1)[0])
# 数据点与原先的进行画图比较
fitted_angle1 = A1 * np.exp((-1) * B1 * time1) * np.sin(C1 * time1 + D1) + E1
zeta1 = Symbol('zeta1')
omega1 = Symbol('omega1')
solved_value1=solve([zeta1 * omega1 - B1, omega1 * ((1 - (zeta1*zeta1))**0.5) - C1], [zeta1, omega1])
print(solved_value1)
zeta1 = solved_value1[0][0]
omega1 = solved_value1[0][1]
frequency1 = omega1 / 2 / math.pi

plt.subplots(figsize=(8, 5), dpi=100)
plt.subplot(311)
plt.plot(time, angle, 'b-+', label='original curve')
plt.plot(time, fitted_angle,'r--', label='fitted curve')
latex = r'$s(t) = \mathcal{A}\/e^{-\lambda t}\/sin(\omega t + \Phi) +\mathcal{C} \/ (\mathcal{A}:%.2f,\lambda:%.2f,\omega:%.2f,\Phi:%.2f,\mathcal{C}:%.2f)$' % (A,B,C,D,E)
plt.title(latex, size = 'large')
plt.text(0,65,'The zeta is: %.3f' % zeta, fontsize=15)
plt.text(0,55,'The omega is: %.3f' % omega, fontsize=15)
plt.text(0,75,'The frequency is: %.3f' % frequency, fontsize=15)
plt.xlabel('Time [s]', fontweight ='bold')
plt.ylabel('Previous Angular Displacement [degree]',fontweight ='bold')
plt.grid()
plt.legend()
plt.ylim([-50, 50])
plt.ylim([-50, 50])

plt.subplot(313)
plt.plot(time1, degree1, 'b-+', label='original curve')
plt.plot(time1, fitted_angle1,'r--', label='fitted curve')
latex = r'$s(t) = \mathcal{A}\/e^{-\lambda t}\/sin(\omega t + \Phi) +\mathcal{C} \/ (\mathcal{A}:%.2f,\lambda:%.2f,\omega:%.2f,\Phi:%.2f,\mathcal{C}:%.2f)$' % (A1,B1,C1,D1,E1)
plt.title(latex, size = 'large')
plt.text(0,85,'The zeta is: %.3f' % zeta1, fontsize=15)
plt.text(0,75,'The omega is: %.3f' % omega1, fontsize=15)
plt.text(0,95,'The frequency is: %.3f' % frequency1, fontsize=15)
plt.xlabel('Time [s]', fontweight ='bold')
plt.ylabel('Latest Angular Displacement [degree]',fontweight ='bold')
plt.grid()
plt.legend()
plt.ylim([-70, 70])
plt.ylim([-70, 70])

plt.show()